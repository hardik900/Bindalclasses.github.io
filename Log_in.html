<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clear Vision</title>
</head>
<body>
    <h2>LOG IN</h2>
    <label >E:mail</label>
    <input type="email" id="mail"></INPUT> <br>
    <label >Password</label>
    <input type="password" id="pwd"></INPUT> <br>
    <p>Don't have an account then Please <a href="Sign-up_for_multiple_users_using_local_storage.html">Sign up</a></p>
    <input type="submit" value="Log In" onclick="hello()">
    <p id="sam"></p>
    <script>
        function hello(){
            let mail = document.getElementById("mail").value;
            let pwd = document.getElementById("pwd").value;

            if( ((mail,pwd) != '')){
                log_In();
            }
            else{
                alert("Please Fill the fields")
            }
        }
        function log_In(){
            let mail = document.getElementById("mail").value;
            let pwd = document.getElementById("pwd").value;
            // let f_name = document.getElementById("f_name").value;
            // let L_name = document.getElementById("L_name").value;
            
            let store = JSON.parse(localStorage.getItem("user"));
            // console.log(store);
            var arr_email = [];
            var arr_pwd = [];

            for(i=0; i<store.length; i++){
                var store_mail = store[i].email;
                arr_email.push(store_mail);

                var store_pwd = store[i].password;
                arr_pwd.push(store_pwd);
            }
            console.log(arr_email,"email");
            console.log(arr_pwd,"pwd");

            let filter_mail = "";
            filter_mail = arr_email.filter((aa)=>{
                if(mail == aa){
                    return 1;
                }
            });
            let filter_pwd = "";
            filter_pwd = arr_pwd.filter((bb)=>{
                if(pwd == bb){
                    return 1;
                }
            });

            let indexFindmail = "";
            indexFindmail = arr_email.findIndex((cc)=>{
                if(mail == cc){
                    return 1;
                }
            });
            // console.log(indexFindmail,"indexFindmail");

            let indexFindpwd = "";
            indexFindpwd = arr_pwd.findIndex((dd)=>{
                if(pwd == dd){
                    return 2;
                }
            });
            // console.log(indexFindpwd,"indexFindpwd");

            let qq = indexFindmail;
            let ww = indexFindpwd;

            let check_email = mail.includes("@");
            if(check_email == false ){
                alert("Please Enter a valid mail");
            }

            else if(qq === ww && mail === filter_mail[0] && (pwd === filter_pwd[0])){
                // document.getElementById("sam").innerHTML = `Welcome ${full_Name}`;
                location.href ="open.html"
                let full_Name = store[qq].f_name + " " + store[qq].L_name;
                localStorage.setItem("log",JSON.stringify(full_Name))
            }
            else{
                alert("PLease Fill the correct details")
            }
            // console.log(filter_pwd,"pwd");
            // console.log(filter_mail,"mail");








            // 2 method
            // let store = JSON.parse(localStorage.getItem("user"));
            // for(i=0; i<store.length; i++){
            //     let store_mail = store[i].email;
            //     let store_pwd = store[i].password;
            //     if(mail == store_mail && pwd == store_pwd){
            //         document.getElementById("sam").innerHTML = 'Done';
            //     }
            // }
            

        }
        </script>
</body>
</html>